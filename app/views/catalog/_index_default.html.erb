<%# default partial to display solr document fields in catalog index view -%>
<% document_empty  = !FileServer.doc_has_text(document['id']) %>
<% facsimile_empty  = !FileServer.has_facsimile(document.id) %>
<div class="x">
<dl class="document-metadata dl-horizontal dl-invert">
  <% collapse_id = "collapse-"+document['id'].gsub("#", "") %>
  <% result_id = "result-"+document['id'].gsub("#", "") %>
  <% text_label_id = "text-label-"+document['id'].gsub("#", "") %>

  <% collapse_fields = [] %>
  <% index_fields(document).each do |field_name, field| -%>
      <% if should_render_index_field? document, field %>
          <% label = render_index_field_label document, field: field_name %>
          <% value = render_index_field_value document, field: field_name %>
          <% if value.present? and field.short_form %>
              <dt class="blacklight-<%= field_name.parameterize %>"><%= label %></dt>
              <dd class="blacklight-<%= field_name.parameterize %>"><%= value %></dd>
          <% elsif value.present?  %>
              <% collapse_fields << [label, value, field_name] %>
          <% end %>
      <% end -%>
  <% end -%>

  <dt id=<%= text_label_id %>><%= t('blacklight.search.index.in_text') %></dt>
  <dd class="search-results" id =<%= result_id %> ></dd>

  <dt><%= t('blacklight.search.index.download') %></dt>
  <dd>
    <% unless document_empty %>
        <%= link_to(solr_document_path(document, format: :pdf), class:'dlTxt') do %>
            <%= bootstrap_glyphicon 'align-left' %>
            <%= t('blacklight.search.index.text') %>
        <% end %>
    <% end %>
    <% unless facsimile_empty %>
        <%= link_to(facsimile_catalog_path(document.id, format: :pdf), class:'dlFaks') do %>
            <%= bootstrap_glyphicon 'book' %>
            <%= t('blacklight.search.index.facsimile') %>
        <% end %>
    <% end %>
  </dd>


  <div class="long_form_collapse collapse" id=<%= collapse_id %>>
    <% collapse_fields.each do |label, value, field_name| %>
          <dt class="blacklight-<%= field_name.parameterize %>"><%= label %></dt>
          <dd class="blacklight-<%= field_name.parameterize %>"><%= value %></dd>
    <% end %>
  </div>
  <% unless collapse_fields.empty? %>
      <a class="collapse-button" role="button" data-toggle="collapse" href="#<%= collapse_id %>" aria-expanded="false" aria-controls="<%= collapse_id %>" onclick="changeButtonLabel(this);">
        <%= t('blacklight.search.index.show_more') %>
      </a>
  <% end %>

</dl>
</div>
<%= javascript_tag do %>
    $(document).ready(
            function () {
                index_work_search("<%= document['id'] %>", $('#<%= result_id %>'), $('#<%= text_label_id %>'));
            });
<% end %>
